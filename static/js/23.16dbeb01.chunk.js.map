{"version":3,"sources":["views/Profile/index.js","api/common.js"],"names":["Profile","connect","state","avatar","userReducer","changeAvatar","isUploading","handleUpload","arg","setState","data","FormData","append","file","uploadImg","then","res","status","props","linkurl","success","error","finally","firObj","name","todos","Object","assign","_","cloneDeep","push","Map","a","b","c","set","map_1","map_2","console","log","equals","imList_1","List","imObj_1","fromJS","getIn","imObj_2","setIn","imObj_3","updateIn","v","this","title","bordered","showUploadList","disabled","openFileDialogOnClick","customRequest","style","display","width","height","border","lineHeight","textAlign","src","alt","type","Component","params","axios","post","testApi","get"],"mappings":"4TAeMA,EADLC,aANuB,SAACC,GACvB,MAAO,CACLC,OAAQD,EAAME,YAAYD,UAIJ,CAAEE,kB,+MAE1BH,MAAQ,CACNI,aAAa,G,EAGfC,aAAe,SAACC,GACd,EAAKC,SAAS,CACZH,aAAa,IAEf,IAAMI,EAAO,IAAIC,SACjBD,EAAKE,OACH,QACA,0LAEFF,EAAKE,OAAO,OAAQJ,EAAIK,MACxBC,YAAUJ,GACPK,MAAK,SAACC,GACDA,EAAIC,QACN,EAAKR,SAAS,CACZH,aAAa,IAEf,EAAKY,MAAMb,aAAaW,EAAIN,KAAKS,SACjC,IAAQC,QAAQ,yCAEhB,IAAQC,MAAM,2CAGjBC,SAAQ,WACP,EAAKb,SAAS,CACZH,aAAa,Q,4CAKrB,WAEE,IAAMiB,EAAS,CACbC,KAAM,MACNC,MAAO,CAAC,qBAAO,eAAM,iBAEVC,OAAOC,OAAO,GAAIJ,GAClBK,IAAEC,UAAUN,GAEzBA,EAAOE,MAAMK,KAAK,OAWAC,YALJ,CACZC,EAAG,EACHC,EAAG,EACHC,EAAG,IAIuBC,IAAI,IAAK,GAPrC,IAUMC,EAAQL,YAAI,CAAEC,EAAG,EAAGC,EAAG,EAAGC,EAAG,IAC7BG,EAAQN,YAAI,CAAEC,EAAG,EAAGC,EAAG,EAAGC,EAAG,IACnCI,QAAQC,IAAIH,IAAUC,GACtBC,QAAQC,IAAIH,EAAMI,OAAOH,IAGzB,IAAMI,EAAWC,YAAK,CAAC,EAAG,IAOpBC,GANWF,EAASX,OAETW,EAASX,KAAK,EAAG,EAAG,GAIrBc,YAAOrB,IAEvBe,QAAQC,IAAII,EAAQE,MAAM,CAAC,QAAS,KACpC,IAAMC,EAAUH,EAAQI,MAAM,CAAC,SAAU,IAAK,KAAM,KAWpDT,QAAQC,IAAIO,EAAQD,MAAM,CAAC,SAAU,IAAK,OAG1C,IAAMG,EAAUL,EAAQM,SAAS,CAAC,SAAU,IAAK,MAAM,SAACC,GAAD,OAAY,OACnEZ,QAAQC,IAAIS,EAAQH,MAAM,CAAC,SAAU,IAAK,OAI1C,IAAQvC,EAAgB6C,KAAKjD,MAArBI,YACR,OACE,uBAAM8C,MAAM,2BAAOC,UAAU,GAC3B,uBACEC,gBAAgB,EAChBC,SAAUjD,EACVkD,uBAAuB,EACvBC,cAAeN,KAAK5C,cAEpB,yBACEmD,MAAO,CACLC,QAAS,QACTC,MAAO,QACPC,OAAQ,QACRC,OAAQ,qBACRC,WAAY,QACZC,UAAW,WAGZb,KAAKjC,MAAMf,OACV,yBACE8D,IAAKd,KAAKjC,MAAMf,OAChB+D,IAAI,aACJR,MAAO,CAAEE,MAAO,QAASC,OAAQ,WAGnC,2BACE,uBAAMM,KAAK,WADb,mC,GAxHQC,e,EAoIPpE,a,iCCnJf,yFAEac,EAAY,SAACuD,GACxB,OAAOC,IAAMC,KAAK,uBAAwBF,IAE/BG,EAAU,WACrB,OAAOF,IAAMG,IAAI","file":"static/js/23.16dbeb01.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { message, Upload, Card, Button, Icon } from \"antd\";\r\nimport { uploadImg } from \"../../api/common\";\r\nimport { changeAvatar } from \"../../store/actions/userAction\";\r\nimport _ from \"lodash\";\r\nimport { Map, List, fromJS } from \"immutable\";\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    avatar: state.userReducer.avatar,\r\n  };\r\n};\r\n\r\n@connect(mapStateToProps, { changeAvatar })\r\nclass Profile extends Component {\r\n  state = {\r\n    isUploading: false,\r\n  };\r\n\r\n  handleUpload = (arg) => {\r\n    this.setState({\r\n      isUploading: true,\r\n    });\r\n    const data = new FormData();\r\n    data.append(\r\n      \"Token\",\r\n      \"fba9dea75c5773b9bbab4bf11ca5d35036f12acb:S-LZNq_wjF9l9i0GOx9Uz3EXZII=:eyJkZWFkbGluZSI6MTU4MDc0MTAyOCwiYWN0aW9uIjoiZ2V0IiwidWlkIjoiNzA4NzAzIiwiYWlkIjoiMTY2MTkzOCIsImZyb20iOiJmaWxlIn0=\"\r\n    );\r\n    data.append(\"file\", arg.file);\r\n    uploadImg(data)\r\n      .then((res) => {\r\n        if (res.status) {\r\n          this.setState({\r\n            isUploading: false,\r\n          });\r\n          this.props.changeAvatar(res.data.linkurl);\r\n          message.success(\"图片上传成功\");\r\n        } else {\r\n          message.error(\"图片上传失败\");\r\n        }\r\n      })\r\n      .finally(() => {\r\n        this.setState({\r\n          isUploading: false,\r\n        });\r\n      });\r\n  };\r\n\r\n  render() {\r\n    // lodash深拷贝学习\r\n    const firObj = {\r\n      name: \"tom\",\r\n      todos: [\"敲代码\", \"吃饭\", \"睡觉\"],\r\n    };\r\n    let newObj = Object.assign({}, firObj); // 浅拷贝\r\n    let lodObj = _.cloneDeep(firObj); // 深拷贝\r\n\r\n    firObj.todos.push(\"sks\");\r\n    // console.log({newObj, lodObj})\r\n\r\n    // ------------------------------------------------------------\r\n    // immutable学习\r\n    // Map可以理解为做对象的\r\n    const state = {\r\n      a: 1,\r\n      b: 2,\r\n      c: 3,\r\n    };\r\n    const imState_1 = Map(state);\r\n    // console.log(state.a, imState_1.get('a')) // 1, 1\r\n    const imState_2 = imState_1.set(\"b\", 2); // 返回新的对象\r\n    // console.log(imState_1 === imState_2) // true immutable：设置的值相同引用的地址就不变，哪个值修改了就重新单独为那个值开辟新的内存地址\r\n\r\n    const map_1 = Map({ a: 1, b: 2, c: 3 });\r\n    const map_2 = Map({ a: 1, b: 2, c: 3 });\r\n    console.log(map_1 === map_2); // false\r\n    console.log(map_1.equals(map_2)); // true\r\n\r\n    // List做数组的\r\n    const imList_1 = List([1, 2]);\r\n    const imList_2 = imList_1.push();\r\n    // console.log(imList_1 === imList_2) // true\r\n    const imList_3 = imList_1.push(3, 4, 5);\r\n    // console.log(imList_1.get(4), imList_3.get(4)) // undefined, 5\r\n\r\n    // fromJS复杂数据类型\r\n    const imObj_1 = fromJS(firObj);\r\n    // console.log(imObj_1.get('todos').get(0)) 等同于下面的 getIn\r\n    console.log(imObj_1.getIn([\"todos\", 1]));\r\n    const imObj_2 = imObj_1.setIn([\"firObj\", \"x\", \"y\"], 100);\r\n    /* \r\n      {\r\n        name: 'tom',\r\n        todos: ['敲代码', '吃饭', '睡觉'],\r\n        x: {\r\n          y: 100,\r\n          z: 808\r\n        }\r\n      }\r\n    */\r\n    console.log(imObj_2.getIn([\"firObj\", \"x\", \"y\"]));\r\n    // console.log(imObj_2.toJS().firObj.x.y) // 等同于上面\r\n\r\n    const imObj_3 = imObj_1.updateIn([\"firObj\", \"x\", \"z\"], (v) => (v = 808));\r\n    console.log(imObj_3.getIn([\"firObj\", \"x\", \"z\"]));\r\n\r\n    // ------------------------------------------------------------\r\n\r\n    const { isUploading } = this.state;\r\n    return (\r\n      <Card title=\"个人设置\" bordered={false}>\r\n        <Upload\r\n          showUploadList={false}\r\n          disabled={isUploading}\r\n          openFileDialogOnClick={true}\r\n          customRequest={this.handleUpload}\r\n        >\r\n          <div\r\n            style={{\r\n              display: \"block\",\r\n              width: \"150px\",\r\n              height: \"150px\",\r\n              border: \"1px dashed #dedede\",\r\n              lineHeight: \"150px\",\r\n              textAlign: \"center\",\r\n            }}\r\n          >\r\n            {this.props.avatar ? (\r\n              <img\r\n                src={this.props.avatar}\r\n                alt=\"loading...\"\r\n                style={{ width: \"148px\", height: \"148px\" }}\r\n              />\r\n            ) : (\r\n              <Button>\r\n                <Icon type=\"upload\" />\r\n                点击上传\r\n              </Button>\r\n            )}\r\n          </div>\r\n        </Upload>\r\n      </Card>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Profile;\r\n","import axios from 'axios'\r\n\r\nexport const uploadImg = (params) => {\r\n  return axios.post('http://up.imgapi.com', params)\r\n}\r\nexport const testApi = () => {\r\n  return axios.get('http://127.0.0.1:8010')\r\n}\r\n"],"sourceRoot":""}